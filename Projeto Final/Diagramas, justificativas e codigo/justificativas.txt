→ Diagrama ER e justificativas (explicado de forma simples)

- Principais escolhas do modelo

Separação em entidades principais
Paciente, Profissional, Internação, Leito, Exame, Fatura, Prescrição — dessa forma
cada parte do hospital tem seus próprios dados.

Uso de subtipos
PROFISSIONAL → MEDICO / ENFERMEIRO
Isso evita tabelas duplicadas e deixa claro que todo médico e enfermeiro são profissionais.

Relações 1:N para situações naturais
1 paciente → várias internações

1 profissional → vários agendamentos

1 prescrição → vários itens

1 fatura → vários pagamentos
Faz sentido, porque na prática essas relações acontecem assim mesmo.

Relacionamento N:N entre médico e especialidade
Um médico pode ter várias especialidades.
Uma especialidade pode servir vários médicos.
Por isso criamos a tabela MEDICO_ESPECIALIDADE.

Uso de tabelas de apoio (telefone, fatura_item, prescricao_item)
Evita colocar informações repetidas na tabela principal.


→ Problemas encontrados e soluções adotadas

❌ Problema 1 — Erros com IDs automáticos (Oracle gerando valores estranhos)
O Oracle ao gerar IDs, às vezes começa em 1, 2, 21…

✅ Solução: Usamos GENERATED BY DEFAULT AS IDENTITY e recriamos algumas tabelas quando necessário.

❌ Problema 2 — Package não compilava (Identificador não declarado)
O Oracle reclamava que a função fn_leito_disponivel “não existia”.

✅ Solução: Criamos a função antes do package e recompilamos tudo na ordem.

❌ Problema 3 — Relacionamentos 1:1 (super/subtipo)
PROFISSIONAL → MEDICO / ENFERMEIRO exigia PK = FK, o que costuma dar erro se feito fora de ordem.

✅ Solução:
criar PROFISSIONAL primeiro, depois MEDICO e ENFERMEIRO
Assim não ocorre “parent key not found”.

❌ Problema 4 — Integridade do LEITO durante internação
Era fácil registrar internação em leito já ocupado.

✅ Solução: Criamos função e procedimentos que verificam status do leito e atualizam automaticamente.


